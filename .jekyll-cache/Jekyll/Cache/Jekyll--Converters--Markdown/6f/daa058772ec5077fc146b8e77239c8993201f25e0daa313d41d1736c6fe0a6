I"È'<h2 id="info">Info</h2>
<h3 id="summary">Summary</h3>
<p>ìœˆë„ìš°ì˜ í…ìŠ¤íŠ¸ ë·°ì–´ í”„ë¡œê·¸ë¨ì´ ë„ˆë¬´ ì ì–´ ì§ì ‘ ë§Œë“¤ì–´ë³´ì•˜ìŠµë‹ˆë‹¤. ì›¹ í˜ì´ì§€ë¡œ ë™ì‘í•˜ì—¬ê¸ˆ í•˜ì—¬ ì ‘ê·¼ì„±ì„ ë†’ì—¬ë³´ì•˜ìŠµë‹ˆë‹¤.</p>

<h3 id="platform">Platform</h3>
<p>HTML, Node.js</p>

<h3 id="functions">Functions</h3>
<ul>
  <li>í•„ìˆ˜ê¸°ëŠ¥:
    <ol>
      <li>âœ… í…ìŠ¤íŠ¸ ì½ì–´ì˜¤ê¸°</li>
      <li>âœ… íŒŒì¼ ì—…ë¡œë“œí•˜ê¸°</li>
      <li>âœ… ì±…ê°ˆí”¼ ê¸°ëŠ¥</li>
    </ol>
  </li>
  <li>ì¶”ê°€ê¸°ëŠ¥:
    <ol>
      <li>âŒ ì €ì¥ì†Œë¥¼ ë¶„í• í•˜ì—¬ ì—¬ëŸ¬ ì‚¬ìš©ìê°€ ì‚¬ìš©í• ìˆ˜ ìˆê²Œë”í•˜ê¸°</li>
      <li>âŒ ë¡œê·¸ì¸ ê¸°ëŠ¥ êµ¬í˜„í•˜ê¸°</li>
    </ol>
  </li>
  <li>ë§Œì¡±ê¸°ëŠ¥:
    <ol>
      <li>âŒ ë‹¤ì–‘í•œ ê¸€ê¼´ ë° í¬ê¸° ì œê³µí•˜ê¸°</li>
      <li>âŒ ìê°„, ì¤„ê¸´ê²© ì¡°ì ˆí•˜ê¸°</li>
      <li>âŒ ë°°ê²½ìƒ‰ ë³€í™” ì£¼ê¸°, ë¸”ë£¨ë¼ì´íŒ… ì¤„ì—¬ë³´ê¸°</li>
      <li>âŒ ëˆˆ ê¹œë¹¡ì„ ë©”ì‹œì§€ ë„ìš°ê¸°</li>
    </ol>
  </li>
</ul>

<h2 id="output">Output</h2>
<video controls="">
  <source src="/assets/imgs/post_23/output.mp4" type="video/mp4" />
Your browser does not support the video tag.
</video>

<h2 id="contents">Contents</h2>
<h3 id="ì„œë²„-êµ¬ì¶•">ì„œë²„ êµ¬ì¶•</h3>
<p>ê°€ì¥ ì²˜ìŒ ì´ í”„ë¡œì íŠ¸ë¥¼ ê¸°íší–ˆì„ ë•ŒëŠ” <code class="language-plaintext highlighter-rouge">&lt;input type='file'&gt;</code> íƒœê·¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ë§Œë“œë ¤ í–ˆì—ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ë³´ì•ˆìƒì˜ ë¬¸ì œë¡œ Explorerë¥¼ ì œì™¸í•œ ë¸Œë¼ìš°ì €ì—ì„œëŠ” ì‘ë™í•˜ì§€ ì•ŠëŠ” ê²ƒì„ ê¹¨ë‹«ê³  ë‹¤ë¥¸ ë°©ë²•ì„ ìƒê°í•˜ë˜ ì¤‘ ì„œë²„ë¥¼ ì‚¬ìš©í•´ë³´ë©´ ì–´ë–¨ê¹Œí•˜ëŠ” ìƒê°ì´ ë“¤ì—ˆìŠµë‹ˆë‹¤. í•˜ì—¬ ì„œë²„ì— íŒŒì¼ì„ ì—…ë¡œë“œí•˜ê³  ë¶ˆëŸ¬ì˜¤ëŠ” ë°©í–¥ìœ¼ë¡œ ê°œë°œì„ ì§„í–‰í•´ë³´ì•˜ìŠµë‹ˆë‹¤.</p>

<p>ì„œë²„ëŠ” Node.jsë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬ì¶•í•˜ì˜€ê³ , í´ë¼ì´ì–¸íŠ¸ëŠ” Vue ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í™œìš©í•˜ì—¬ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.</p>

<p>ì¶”ê°€ë¡œ, íŒŒì¼ì„ ì½ì–´ì˜¤ê¸° ìœ„í•´ <code class="language-plaintext highlighter-rouge">fs</code> ëª¨ë“ˆì„, ë¼ìš°íŒ…ì„ ì§ê´€ì ìœ¼ë¡œ í‘œì‹œí•˜ê¸° ìœ„í•´ <code class="language-plaintext highlighter-rouge">express</code> ëª¨ë“ˆì„, íŒŒì¼ì„ ì—…ë¡œë“œí•˜ëŠ”ë° ì‚¬ìš©í•˜ê¸° ìœ„í•´ <code class="language-plaintext highlighter-rouge">multer</code> ëª¨ë“ˆì„ ì„¤ì¹˜ ë° ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.</p>

<p>â— requestì˜ body contentsë¥¼ ë¶ˆëŸ¬ì˜¤ê¸° ìœ„í•´ì„  body-parser ëª¨ë“ˆì„ ì‚¬ìš©í–ˆì—ˆì§€ë§Œ, express ëª¨ë“ˆì´ í•´ë‹¹ ê¸°ëŠ¥ì„ ëŒ€ì²´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// before</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">bodyParser</span><span class="p">.</span><span class="nx">urlencoded</span><span class="p">({</span><span class="na">extended</span><span class="p">:</span> <span class="kc">false</span><span class="p">}));</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">bodyParser</span><span class="p">.</span><span class="nx">json</span><span class="p">());</span>
<span class="c1">// after</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">urlencoded</span><span class="p">({</span><span class="na">extended</span><span class="p">:</span> <span class="kc">false</span><span class="p">}));</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">json</span><span class="p">());</span>
</code></pre></div></div>

<p>ë‹¤ìŒì€ ì„œë²„ê°€ í•˜ëŠ” ì¼ì„ ì½”ë“œì™€ í•¨ê»˜ ê°„ëµí•˜ê²Œ ì •ë¦¬í•´ë³´ì•˜ìŠµë‹ˆë‹¤.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">GET</code>: <code class="language-plaintext highlighter-rouge">/</code> : Main í˜ì´ì§€ë¥¼ ë„ì›ë‹ˆë‹¤.</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="dl">'</span><span class="s1">./pages/index.html</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">writeHead</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="p">{</span><span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span> <span class="p">:</span> <span class="dl">'</span><span class="s1">text/html</span><span class="dl">'</span><span class="p">})</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
    <span class="p">})</span>
<span class="p">})</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">GET</code>: <code class="language-plaintext highlighter-rouge">/files</code> : ì €ì¥ì†Œì— ì €ì¥ë˜ì–´ ìˆëŠ” íŒŒì¼ë“¤ì˜ ì´ë¦„ì„ ë°˜í™˜í•©ë‹ˆë‹¤.</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">/files</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readdirSync</span><span class="p">(</span><span class="nx">__dirname</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">/storage</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">)</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span>
<span class="p">})</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">GET</code>: <code class="language-plaintext highlighter-rouge">/files/:file</code> : <code class="language-plaintext highlighter-rouge">:file</code>ì— ë“¤ì–´ê°„ â€œíŒŒì¼ì´ë¦„â€ìœ¼ë¡œ ì €ì¥ì†Œì—ì„œ íƒìƒ‰í•˜ì—¬ í…ìŠ¤íŠ¸ì˜ ë‚´ìš©ì„ ë°˜í™˜í•©ë‹ˆë‹¤. ì´ ë•Œ, ì–´ë””ê¹Œì§€ ì½ì—ˆëŠ”ì§€ì™€ ë¶ë§ˆí¬ì˜ ìœ ë¬´ì— ëŒ€í•œ ì •ë³´ë¥¼ í•¨ê»˜ ë°˜í™˜í•©ë‹ˆë‹¤.</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">/files/:file</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">file</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">file</span>
    <span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="s2">`./cache/datastore.json`</span><span class="p">,</span> <span class="dl">'</span><span class="s1">utf-8</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">datastore</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
        
        <span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="s2">`./storage/</span><span class="p">${</span><span class="nx">file</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span> <span class="dl">'</span><span class="s1">utf-8</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">datastore</span><span class="p">).</span><span class="nx">includes</span><span class="p">(</span><span class="nx">file</span><span class="p">))</span> 
            <span class="nx">datastore</span><span class="p">[</span><span class="nx">file</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="na">scrollTop</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="na">bookmarkId</span><span class="p">:</span> <span class="kc">null</span>
            <span class="p">};</span>
            <span class="nx">res</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">text/json</span><span class="dl">'</span><span class="p">);</span>
            <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">({</span>
                <span class="na">data</span><span class="p">:</span> <span class="nx">data</span><span class="p">,</span>
                <span class="na">scrollTop</span><span class="p">:</span> <span class="nx">datastore</span><span class="p">[</span><span class="nx">file</span><span class="p">].</span><span class="nx">scrollTop</span><span class="p">,</span>
                <span class="na">bookmarkId</span><span class="p">:</span> <span class="nx">datastore</span><span class="p">[</span><span class="nx">file</span><span class="p">].</span><span class="nx">bookmarkId</span>
            <span class="p">})</span>
        <span class="p">})</span>
    <span class="p">})</span>
<span class="p">})</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">POST</code>: <code class="language-plaintext highlighter-rouge">/uploadbookmark</code> : í˜„ì¬ <code class="language-plaintext highlighter-rouge">:file</code>ì˜ bookmarkë¥¼ ì‚¬ìš©ì Cacheì— ì €ì¥í•©ë‹ˆë‹¤.</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="dl">'</span><span class="s1">/uploadbookmark</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="p">{</span><span class="nx">title</span><span class="p">,</span> <span class="nx">scrollTop</span><span class="p">,</span> <span class="nx">bookmarkId</span><span class="p">}</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>
    <span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="dl">'</span><span class="s1">./cache/datastore.json</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">utf-8</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">datastore</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">datastore</span><span class="p">).</span><span class="nx">includes</span><span class="p">(</span><span class="nx">title</span><span class="p">))</span> 
            <span class="nx">datastore</span><span class="p">[</span><span class="nx">title</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="na">scrollTop</span><span class="p">:</span> <span class="nx">scrollTop</span><span class="p">,</span>
                <span class="na">bookmarkId</span><span class="p">:</span> <span class="nx">bookmarkId</span>
            <span class="p">};</span>
        <span class="k">else</span><span class="p">{</span>
            <span class="nx">datastore</span><span class="p">[</span><span class="nx">title</span><span class="p">].</span><span class="nx">scrollTop</span> <span class="o">=</span> <span class="nx">scrollTop</span>
            <span class="nx">datastore</span><span class="p">[</span><span class="nx">title</span><span class="p">].</span><span class="nx">bookmarkId</span> <span class="o">=</span> <span class="nx">bookmarkId</span>
        <span class="p">}</span>
        <span class="nx">fs</span><span class="p">.</span><span class="nx">writeFileSync</span><span class="p">(</span><span class="dl">'</span><span class="s1">./cache/datastore.json</span><span class="dl">'</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">datastore</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="dl">'</span><span class="s1">utf-8</span><span class="dl">'</span><span class="p">);</span>
        <span class="c1">// res.set('Content-Type', 'text/json');</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">()</span>
    <span class="p">})</span>
<span class="p">})</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">POST</code>: <code class="language-plaintext highlighter-rouge">/uploadfile</code> : ì €ì¥ì†Œì— ìƒˆë¡œìš´ íŒŒì¼ì„ ì—…ë¡œë“œí•©ë‹ˆë‹¤.</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="dl">'</span><span class="s1">/uploadfile</span><span class="dl">'</span><span class="p">,</span> <span class="nx">upload</span><span class="p">.</span><span class="nx">single</span><span class="p">(</span><span class="dl">'</span><span class="s1">file</span><span class="dl">'</span><span class="p">),</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">)</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">file</span><span class="p">)</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">204</span><span class="p">).</span><span class="nx">redirect</span><span class="p">(</span><span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">)</span>
<span class="p">})</span>
</code></pre></div></div>

<h3 id="í…ìŠ¤íŠ¸-ì½ì–´ì˜¤ê¸°">í…ìŠ¤íŠ¸ ì½ì–´ì˜¤ê¸°</h3>
<p>ì•ì„œ ì„¤ëª…í•œ ê²ƒì²˜ëŸ¼ â€˜í…ìŠ¤íŠ¸ ì½ì–´ì˜¤ê¸°â€™ ê¸°ëŠ¥ì€ <code class="language-plaintext highlighter-rouge">GET: /files/:file</code>ì—ì„œ ì‘ë™í•©ë‹ˆë‹¤.</p>

<p>ì½ì–´ì˜¬ íŒŒì¼ëª…ì€ íŒŒë¼ë¯¸í„°ë¡œ ë„˜ì–´ì˜¨ <code class="language-plaintext highlighter-rouge">:file</code>ì—ì„œ ê°€ì ¸ì˜µë‹ˆë‹¤.</p>

<p>ë³¸ê²©ì ì¸ í…ìŠ¤íŠ¸ì˜ ë‚´ìš©ì„ ì½ê¸° ì „ì— ì‚¬ìš©ì Cacheë¥¼ ë¶ˆëŸ¬ì™€ ì´ì „ì— ì‚¬ìš©ìê°€ í•´ë‹¹ íŒŒì¼ì„ ì½ì€ ì ì´ ìˆëŠ”ì§€ ì—¬ë¶€ë¥¼ íŒë‹¨í•©ë‹ˆë‹¤.</p>

<p>ì‚¬ìš©ìì˜ ì—´ëŒ ìœ ë¬´ë¥¼ ë°”íƒ•ìœ¼ë¡œ í…ìŠ¤íŠ¸ì˜ ë‚´ìš©ê³¼ ë¶ë§ˆí¬ ìœ ë¬´, ê·¸ë¦¬ê³  ì–´ë””ê¹Œì§€ ì½ì—ˆëŠ”ì§€ë¥¼ í•¨ê»˜ ë°˜í™˜í•©ë‹ˆë‹¤.</p>

<p>ë°˜í™˜ëœ ì •ë³´ëŠ” ì´í›„ htmlì— ëª…ì‹œëœ javascriptì™€ vueë¥¼ í†µí•´ í™”ë©´ì— í‘œì‹œë©ë‹ˆë‹¤.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Server</span>
<span class="nx">app</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">/files/:file</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">file</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">file</span>
    <span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="s2">`./cache/datastore.json`</span><span class="p">,</span> <span class="dl">'</span><span class="s1">utf-8</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">datastore</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
        
        <span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="s2">`./storage/</span><span class="p">${</span><span class="nx">file</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span> <span class="dl">'</span><span class="s1">utf-8</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">datastore</span><span class="p">).</span><span class="nx">includes</span><span class="p">(</span><span class="nx">file</span><span class="p">))</span> 
            <span class="nx">datastore</span><span class="p">[</span><span class="nx">file</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="na">scrollTop</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="na">bookmarkId</span><span class="p">:</span> <span class="kc">null</span>
            <span class="p">};</span>
            <span class="nx">res</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">text/json</span><span class="dl">'</span><span class="p">);</span>
            <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">({</span>
                <span class="na">data</span><span class="p">:</span> <span class="nx">data</span><span class="p">,</span>
                <span class="na">scrollTop</span><span class="p">:</span> <span class="nx">datastore</span><span class="p">[</span><span class="nx">file</span><span class="p">].</span><span class="nx">scrollTop</span><span class="p">,</span>
                <span class="na">bookmarkId</span><span class="p">:</span> <span class="nx">datastore</span><span class="p">[</span><span class="nx">file</span><span class="p">].</span><span class="nx">bookmarkId</span>
            <span class="p">})</span>
        <span class="p">})</span>
    <span class="p">})</span>
<span class="p">})</span>
<span class="c1">// Client</span>

<span class="p">...</span>

<span class="nx">fetch</span><span class="p">(</span><span class="s2">`http://localhost:3000/files/</span><span class="p">${</span><span class="nx">t</span><span class="p">.</span><span class="nx">innerText</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span> <span class="c1">// clickí•œ íŒŒì¼ëª…ìœ¼ë¡œ ì„œë²„ì— ìš”ì²­ì„ ë³´ëƒ„</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>                        <span class="c1">// json ë°ì´í„° íŒŒì‹±</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">app</span><span class="p">.</span><span class="nx">bookmarkId</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">bookmarkId</span><span class="p">;</span>            <span class="c1">// Vue ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ data ê°’ ë³€ê²½</span>
        <span class="nx">app</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">;</span>              <span class="c1">// Vue ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ data ê°’ ë³€ê²½</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="se">\n</span><span class="dl">'</span><span class="p">);</span>                <span class="c1">// ì½ì€ í…ìŠ¤íŠ¸ íŒŒì¼ì„ ì¤„ë§ˆë‹¤ ì˜ë¼ì„œ ì €ì¥ =&gt; Array()</span>
    <span class="p">})</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">app</span><span class="p">.</span><span class="nx">text</span> <span class="o">=</span> <span class="nx">res</span><span class="p">)</span>                    <span class="c1">// ë°°ì—´í˜•ì‹ì˜ ë°ì´í„°ë¥¼ Vue dataì— ì €ì¥ =&gt; v-forë¥¼ ì‚¬ìš©í•´ í™”ë©´ì— í‘œì‹œë¨</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">app</span><span class="p">.</span><span class="nx">bookmarkId</span><span class="p">)</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">app</span><span class="p">.</span><span class="nx">bookmarkId</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundColor</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">#ffc4bb</span><span class="dl">'</span><span class="p">;</span>   <span class="c1">// ë¶ë§ˆí¬ í‘œì‹œ</span>
        <span class="nx">textplace</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">=</span> <span class="nx">app</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">;</span>                                                            <span class="c1">// ì´ì „ì— ì½ì€ ê³³ê¹Œì§€ ì´ë™</span>
    <span class="p">})</span>
</code></pre></div></div>

<h3 id="íŒŒì¼-ì—…ë¡œë“œí•˜ê¸°">íŒŒì¼ ì—…ë¡œë“œí•˜ê¸°</h3>
<p>ì•ì„œ ë§í–ˆë“¯ì´ íŒŒì¼ì—…ë¡œë“œì—ëŠ” <code class="language-plaintext highlighter-rouge">multer</code>ëª¨ë“ˆì„ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.</p>

<p>ì´ ëª¨ë“ˆì„ ì‚¬ìš©í•˜ë©´ ë‹¨ì¼ íŒŒì¼ì„ ì—…ë¡œë“œí•  ë•Œ <code class="language-plaintext highlighter-rouge">upload.single('file')</code> ëª¨ë“ˆì„ ì•±ì— ë“±ë¡í•˜ì—¬ ì‹¤í–‰ì‹œì¼œì£¼ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤. êµ‰ì¥íˆ ê°„ë‹¨í•˜ì£  :)</p>

<p>ë‹¨, ì´ ë•Œ singleë©”ì†Œë“œì— ë“¤ì–´ê°€ëŠ” ì¸ìëŠ” htmlì— ëª…ì‹œí•œ <code class="language-plaintext highlighter-rouge">&lt;input type="file"&gt;</code> ì˜ name ì†ì„±ì´ì–´ì•¼í•©ë‹ˆë‹¤.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="na">id=</span><span class="s">"root"</span> <span class="na">action=</span><span class="s">"/uploadfile"</span> <span class="na">method=</span><span class="s">"POST"</span> <span class="na">enctype=</span><span class="s">"multipart/form-data"</span><span class="nt">&gt;</span>
    
    ...

    <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"fileselect"</span> <span class="na">type=</span><span class="s">"file"</span> <span class="na">name=</span><span class="s">"file"</span> <span class="na">multiple=</span><span class="s">"multiple"</span> <span class="na">class=</span><span class="s">"addFile"</span> <span class="na">hidden</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">name=</span><span class="s">"submit"</span> <span class="na">id=</span><span class="s">"submitbutton"</span> <span class="na">hidden</span><span class="nt">&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="dl">'</span><span class="s1">/uploadfile</span><span class="dl">'</span><span class="p">,</span> <span class="nx">upload</span><span class="p">.</span><span class="nx">single</span><span class="p">(</span><span class="dl">'</span><span class="s1">file</span><span class="dl">'</span><span class="p">),</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">)</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">file</span><span class="p">)</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">204</span><span class="p">).</span><span class="nx">redirect</span><span class="p">(</span><span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">)</span>
<span class="p">})</span>
</code></pre></div></div>

<h2 id="code">Code</h2>
<p>ì•„ë˜ì— ì£¼ê°€ ë˜ëŠ” íŒŒì¼ë“¤ì˜ ì½”ë“œë¥¼ ì ì–´ë‘ì—ˆìœ¼ë‹ˆ ì°¸ê³ ë°”ëë‹ˆë‹¤.</p>

<h3 id="serverjs">server.js</h3>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">fs</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">express</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">multer</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">multer</span><span class="dl">'</span><span class="p">)</span>


<span class="kd">let</span> <span class="nx">upload</span> <span class="o">=</span> <span class="nx">multer</span><span class="p">({</span>
    <span class="na">storage</span><span class="p">:</span> <span class="nx">multer</span><span class="p">.</span><span class="nx">diskStorage</span><span class="p">({</span>
        <span class="na">destination</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">file</span><span class="p">,</span> <span class="nx">cb</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">cb</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="dl">'</span><span class="s1">./storage/</span><span class="dl">'</span><span class="p">);</span>
        <span class="p">},</span>
        <span class="na">filename</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">file</span><span class="p">,</span> <span class="nx">cb</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">cb</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">file</span><span class="p">.</span><span class="nx">originalname</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}),</span>
<span class="p">})</span>
<span class="kd">let</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">urlencoded</span><span class="p">({</span><span class="na">extended</span><span class="p">:</span> <span class="kc">false</span><span class="p">}));</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">json</span><span class="p">());</span>


<span class="nx">app</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="dl">'</span><span class="s1">./pages/index.html</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">writeHead</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="p">{</span><span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span> <span class="p">:</span> <span class="dl">'</span><span class="s1">text/html</span><span class="dl">'</span><span class="p">})</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
    <span class="p">})</span>
<span class="p">})</span>

<span class="nx">app</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">/files</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readdirSync</span><span class="p">(</span><span class="nx">__dirname</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">/storage</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">)</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span>
<span class="p">})</span>

<span class="nx">app</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">/files/:file</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">file</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">file</span>
    <span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="s2">`./cache/datastore.json`</span><span class="p">,</span> <span class="dl">'</span><span class="s1">utf-8</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">datastore</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
        
        <span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="s2">`./storage/</span><span class="p">${</span><span class="nx">file</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span> <span class="dl">'</span><span class="s1">utf-8</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">datastore</span><span class="p">).</span><span class="nx">includes</span><span class="p">(</span><span class="nx">file</span><span class="p">))</span> 
            <span class="nx">datastore</span><span class="p">[</span><span class="nx">file</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="na">scrollTop</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="na">bookmarkId</span><span class="p">:</span> <span class="kc">null</span>
            <span class="p">};</span>
            <span class="nx">res</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">text/json</span><span class="dl">'</span><span class="p">);</span>
            <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">({</span>
                <span class="na">data</span><span class="p">:</span> <span class="nx">data</span><span class="p">,</span>
                <span class="na">scrollTop</span><span class="p">:</span> <span class="nx">datastore</span><span class="p">[</span><span class="nx">file</span><span class="p">].</span><span class="nx">scrollTop</span><span class="p">,</span>
                <span class="na">bookmarkId</span><span class="p">:</span> <span class="nx">datastore</span><span class="p">[</span><span class="nx">file</span><span class="p">].</span><span class="nx">bookmarkId</span>
            <span class="p">})</span>
        <span class="p">})</span>
    <span class="p">})</span>
    
<span class="p">})</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="dl">'</span><span class="s1">/uploadbookmark</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="p">{</span><span class="nx">title</span><span class="p">,</span> <span class="nx">scrollTop</span><span class="p">,</span> <span class="nx">bookmarkId</span><span class="p">}</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>
    <span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="dl">'</span><span class="s1">./cache/datastore.json</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">utf-8</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">datastore</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">datastore</span><span class="p">).</span><span class="nx">includes</span><span class="p">(</span><span class="nx">title</span><span class="p">))</span> 
            <span class="nx">datastore</span><span class="p">[</span><span class="nx">title</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="na">scrollTop</span><span class="p">:</span> <span class="nx">scrollTop</span><span class="p">,</span>
                <span class="na">bookmarkId</span><span class="p">:</span> <span class="nx">bookmarkId</span>
            <span class="p">};</span>
        <span class="k">else</span><span class="p">{</span>
            <span class="nx">datastore</span><span class="p">[</span><span class="nx">title</span><span class="p">].</span><span class="nx">scrollTop</span> <span class="o">=</span> <span class="nx">scrollTop</span>
            <span class="nx">datastore</span><span class="p">[</span><span class="nx">title</span><span class="p">].</span><span class="nx">bookmarkId</span> <span class="o">=</span> <span class="nx">bookmarkId</span>
        <span class="p">}</span>
        <span class="nx">fs</span><span class="p">.</span><span class="nx">writeFileSync</span><span class="p">(</span><span class="dl">'</span><span class="s1">./cache/datastore.json</span><span class="dl">'</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">datastore</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="dl">'</span><span class="s1">utf-8</span><span class="dl">'</span><span class="p">);</span>
        <span class="c1">// res.set('Content-Type', 'text/json');</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">()</span>
    <span class="p">})</span>
<span class="p">})</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="dl">'</span><span class="s1">/uploadfile</span><span class="dl">'</span><span class="p">,</span> <span class="nx">upload</span><span class="p">.</span><span class="nx">single</span><span class="p">(</span><span class="dl">'</span><span class="s1">file</span><span class="dl">'</span><span class="p">),</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">)</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">file</span><span class="p">)</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">204</span><span class="p">).</span><span class="nx">redirect</span><span class="p">(</span><span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">)</span>
<span class="p">})</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">3000</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">server on 3000 port</span><span class="dl">'</span><span class="p">)</span>
<span class="p">})</span>
</code></pre></div></div>

<h3 id="indexhtml">index.html</h3>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"kr"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width, initial-scale=1.0"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>Text-Viewer by uowol<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdn.jsdelivr.net/npm/vue/dist/vue.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;style&gt;</span>
        <span class="o">*</span><span class="p">{</span>
            <span class="nl">box-sizing</span><span class="p">:</span> <span class="n">border-box</span><span class="p">;</span>

        <span class="p">}</span>
        <span class="nt">html</span><span class="o">,</span> <span class="nt">body</span><span class="p">{</span>
            <span class="nl">width</span><span class="p">:</span> <span class="m">100vw</span><span class="p">;</span>
            <span class="nl">height</span><span class="p">:</span> <span class="m">100vh</span><span class="p">;</span>
            <span class="nl">padding</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
            <span class="nl">margin</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nf">#root</span><span class="p">{</span>
            <span class="nl">display</span><span class="p">:</span> <span class="n">flex</span><span class="p">;</span>
            <span class="nl">width</span><span class="p">:</span> <span class="m">100vw</span><span class="p">;</span>
            <span class="nl">height</span><span class="p">:</span> <span class="m">100vh</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nc">.list</span><span class="p">{</span>
            <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="no">black</span><span class="p">;</span>
            <span class="nl">list-style-type</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
            <span class="nl">height</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
            <span class="nl">margin</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
            <span class="nl">padding</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nc">.item</span><span class="p">{</span>
            <span class="nl">padding</span><span class="p">:</span> <span class="m">5px</span> <span class="m">10px</span><span class="p">;</span>
            <span class="nl">border-bottom</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="m">#cccccc</span><span class="p">;</span>
            <span class="nl">font-family</span><span class="p">:</span> <span class="s2">'Segoe UI'</span><span class="p">,</span> <span class="n">Tahoma</span><span class="p">,</span> <span class="n">Geneva</span><span class="p">,</span> <span class="n">Verdana</span><span class="p">,</span> <span class="nb">sans-serif</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nc">.list</span> <span class="o">&gt;</span> <span class="nt">a</span><span class="p">{</span>
            <span class="nl">text-decoration</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
            <span class="nl">color</span><span class="p">:</span> <span class="m">#2e2e2e</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nc">.nav-box</span><span class="p">{</span>
            <span class="nl">overflow-y</span><span class="p">:</span> <span class="nb">auto</span><span class="p">;</span>
            <span class="nl">width</span><span class="p">:</span> <span class="m">20%</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nc">.textplace</span><span class="p">{</span>
            <span class="nl">overflow</span><span class="p">:</span> <span class="nb">auto</span><span class="p">;</span>
            <span class="nl">flex-grow</span><span class="p">:</span> <span class="m">1</span><span class="p">;</span>
            <span class="nl">padding</span><span class="p">:</span> <span class="m">10px</span><span class="p">;</span>
            <span class="nl">max-width</span><span class="p">:</span> <span class="m">80%</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nc">.filedrag</span><span class="p">{</span>
            <span class="nl">background-color</span><span class="p">:</span> <span class="m">#2e2e2e</span><span class="p">;</span>
            <span class="nl">color</span><span class="p">:</span> <span class="m">#eee</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;form</span> <span class="na">id=</span><span class="s">"root"</span> <span class="na">action=</span><span class="s">"/uploadfile"</span> <span class="na">method=</span><span class="s">"POST"</span> <span class="na">enctype=</span><span class="s">"multipart/form-data"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"nav-box"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"list"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;li</span> <span class="na">id=</span><span class="s">"filedrag"</span> <span class="na">class=</span><span class="s">"item filedrag"</span><span class="nt">&gt;</span>
                    drag a new file on here.
                <span class="nt">&lt;/li&gt;</span>
                <span class="nt">&lt;li</span> <span class="na">v-for=</span><span class="s">"item in itemList"</span> <span class="na">class=</span><span class="s">"item"</span> <span class="err">@</span><span class="na">mouseover=</span><span class="s">"mouseOverEvent"</span> <span class="err">@</span><span class="na">mouseout=</span><span class="s">"mouseOut"</span> <span class="err">@</span><span class="na">click=</span><span class="s">"click"</span><span class="nt">&gt;</span>
                    
                <span class="nt">&lt;/li&gt;</span>
            <span class="nt">&lt;/ul&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"textplace"</span> <span class="na">id=</span><span class="s">"textplace"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;p</span> <span class="na">v-for=</span><span class="s">"(t,i) in text"</span> <span class="na">class=</span><span class="s">"paragraph"</span> <span class="err">@</span><span class="na">click=</span><span class="s">"bookmarking"</span> <span class="na">:id=</span><span class="s">"'p'+i"</span><span class="nt">&gt;&lt;/p&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"fileselect"</span> <span class="na">type=</span><span class="s">"file"</span> <span class="na">name=</span><span class="s">"file"</span> <span class="na">multiple=</span><span class="s">"multiple"</span> <span class="na">class=</span><span class="s">"addFile"</span> <span class="na">hidden</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">name=</span><span class="s">"submit"</span> <span class="na">id=</span><span class="s">"submitbutton"</span> <span class="na">hidden</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;script&gt;</span>
    <span class="kd">let</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Vue</span><span class="p">({</span>
        <span class="na">el</span><span class="p">:</span> <span class="dl">"</span><span class="s2">#root</span><span class="dl">"</span><span class="p">,</span>
        <span class="nx">data</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="na">itemList</span><span class="p">:</span> <span class="p">[],</span>
                <span class="na">text</span><span class="p">:</span> <span class="p">[],</span>
                <span class="na">scrollTop</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="na">now</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
                <span class="na">bookmarkId</span><span class="p">:</span> <span class="kc">null</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="nx">created</span><span class="p">()</span> <span class="p">{</span>
        <span class="p">},</span>
        <span class="nx">mounted</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">mount!</span><span class="dl">'</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="nx">update</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">update!</span><span class="dl">'</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="na">watch</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">text</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="c1">// alert(1)</span>
                <span class="nx">textplace</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">=</span> <span class="nx">app</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">;</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">updated! </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">app</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">, </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">textplace</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="na">methods</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">mouseOverEvent</span> <span class="p">:</span> <span class="p">({</span><span class="nx">target</span><span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="nx">target</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundColor</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">#eee</span><span class="dl">'</span>
            <span class="p">},</span>
            <span class="na">mouseOut</span> <span class="p">:</span> <span class="p">({</span><span class="nx">target</span><span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="nx">target</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundColor</span> <span class="o">=</span> <span class="dl">""</span>
            <span class="p">},</span>
            <span class="na">click</span><span class="p">:</span> <span class="p">({</span><span class="na">target</span><span class="p">:</span> <span class="nx">t</span><span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="c1">// í˜„ì¬ ë¶ë§ˆí¬ ì €ì¥</span>
                <span class="k">if</span><span class="p">(</span><span class="nx">app</span><span class="p">.</span><span class="nx">now</span> <span class="o">&amp;&amp;</span> <span class="nx">app</span><span class="p">.</span><span class="nx">bookmarkId</span><span class="p">){</span>
                    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">save now file...!</span><span class="dl">'</span><span class="p">)</span>
                    <span class="nx">fetch</span><span class="p">(</span><span class="s2">`http://localhost:3000/uploadbookmark`</span><span class="p">,</span> <span class="p">{</span>
                        <span class="na">method</span><span class="p">:</span> <span class="dl">'</span><span class="s1">POST</span><span class="dl">'</span><span class="p">,</span>
                        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
                            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span>
                            <span class="c1">// 'Content-Type': 'application/x-www-form-urlencoded',</span>
                        <span class="p">},</span>
                        <span class="na">body</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
                            <span class="na">title</span><span class="p">:</span> <span class="nx">app</span><span class="p">.</span><span class="nx">now</span><span class="p">,</span>
                            <span class="na">scrollTop</span><span class="p">:</span> <span class="nx">app</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">,</span>
                            <span class="na">bookmarkId</span><span class="p">:</span> <span class="nx">app</span><span class="p">.</span><span class="nx">bookmarkId</span>
                        <span class="p">})</span>
                    <span class="p">}).</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
                        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">load new file...!</span><span class="dl">'</span><span class="p">)</span>
                        <span class="c1">// ìƒˆ íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°</span>
                        <span class="nx">app</span><span class="p">.</span><span class="nx">now</span> <span class="o">=</span> <span class="nx">t</span><span class="p">.</span><span class="nx">innerText</span><span class="p">;</span>
                        <span class="k">if</span><span class="p">(</span><span class="nx">app</span><span class="p">.</span><span class="nx">bookmarkId</span><span class="p">)</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">app</span><span class="p">.</span><span class="nx">bookmarkId</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundColor</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">transparent</span><span class="dl">'</span><span class="p">;</span>
                        <span class="nx">fetch</span><span class="p">(</span><span class="s2">`http://localhost:3000/files/</span><span class="p">${</span><span class="nx">t</span><span class="p">.</span><span class="nx">innerText</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
                            <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
                            <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="p">{</span>
                                <span class="nx">app</span><span class="p">.</span><span class="nx">bookmarkId</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">bookmarkId</span><span class="p">;</span>
                                <span class="nx">app</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">;</span>
                                <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="se">\n</span><span class="dl">'</span><span class="p">);</span>
                            <span class="p">})</span>
                            <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">app</span><span class="p">.</span><span class="nx">text</span> <span class="o">=</span> <span class="nx">res</span><span class="p">)</span>
                            <span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
                                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">app</span><span class="p">.</span><span class="nx">now</span><span class="p">,</span> <span class="nx">app</span><span class="p">.</span><span class="nx">bookmarkId</span><span class="p">)</span>
                                <span class="k">if</span><span class="p">(</span><span class="nx">app</span><span class="p">.</span><span class="nx">bookmarkId</span><span class="p">)</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">app</span><span class="p">.</span><span class="nx">bookmarkId</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundColor</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">#ffc4bb</span><span class="dl">'</span><span class="p">;</span>
                                <span class="nx">textplace</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">=</span> <span class="nx">app</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">;</span>
                            <span class="p">})</span>
                    <span class="p">})</span>
                <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                    <span class="nx">app</span><span class="p">.</span><span class="nx">now</span> <span class="o">=</span> <span class="nx">t</span><span class="p">.</span><span class="nx">innerText</span><span class="p">;</span>
                    <span class="nx">fetch</span><span class="p">(</span><span class="s2">`http://localhost:3000/files/</span><span class="p">${</span><span class="nx">t</span><span class="p">.</span><span class="nx">innerText</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
                        <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
                        <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="p">{</span>
                            <span class="nx">app</span><span class="p">.</span><span class="nx">bookmarkId</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">bookmarkId</span><span class="p">;</span>
                            <span class="nx">app</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">;</span>
                            <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="se">\n</span><span class="dl">'</span><span class="p">);</span>
                        <span class="p">})</span>
                        <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">app</span><span class="p">.</span><span class="nx">text</span> <span class="o">=</span> <span class="nx">res</span><span class="p">)</span>
                        <span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
                            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">app</span><span class="p">.</span><span class="nx">now</span><span class="p">,</span> <span class="nx">app</span><span class="p">.</span><span class="nx">bookmarkId</span><span class="p">)</span>
                            <span class="k">if</span><span class="p">(</span><span class="nx">app</span><span class="p">.</span><span class="nx">bookmarkId</span><span class="p">)</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">app</span><span class="p">.</span><span class="nx">bookmarkId</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundColor</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">#ffc4bb</span><span class="dl">'</span><span class="p">;</span>
                            <span class="nx">textplace</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">=</span> <span class="nx">app</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">;</span>
                        <span class="p">})</span>
                <span class="p">}</span>
                
            <span class="p">},</span>
            <span class="na">bookmarking</span> <span class="p">:</span> <span class="p">(({</span><span class="na">target</span><span class="p">:</span> <span class="nx">t</span><span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="k">if</span><span class="p">(</span><span class="nx">app</span><span class="p">.</span><span class="nx">bookmarkId</span><span class="p">)</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">app</span><span class="p">.</span><span class="nx">bookmarkId</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundColor</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">transparent</span><span class="dl">'</span><span class="p">;</span>
                <span class="nx">t</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundColor</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">#ffc4bb</span><span class="dl">'</span>
                <span class="nx">app</span><span class="p">.</span><span class="nx">bookmarkId</span> <span class="o">=</span> <span class="nx">t</span><span class="p">.</span><span class="nx">id</span>

                <span class="nx">app</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">=</span> <span class="nx">textplace</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">;</span>
                <span class="c1">// alert(app.scrollTop)</span>
            <span class="p">}),</span>
        <span class="p">}</span>
    <span class="p">})</span>

    <span class="nx">fetch</span><span class="p">(</span><span class="dl">'</span><span class="s1">http://localhost:3000/files</span><span class="dl">'</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">()).</span><span class="nx">then</span><span class="p">(</span><span class="nx">arr</span> <span class="o">=&gt;</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">v</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">app</span><span class="p">.</span><span class="nx">itemList</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span>
    <span class="p">}))</span>

    <span class="kd">const</span> <span class="nx">$id</span> <span class="o">=</span> <span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">FileDragHover</span> <span class="o">=</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">e</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>
        <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
        <span class="c1">// e.target.className = (e.type == "dragover" ? "hover" : "");</span>
    <span class="p">}</span>
    <span class="kd">const</span> <span class="nx">FileSelectHandler</span> <span class="o">=</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
	    <span class="c1">// cancel event and hover styling</span>
        <span class="nx">FileDragHover</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
        <span class="c1">// fetch FileList object</span>
        <span class="kd">var</span> <span class="nx">files</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">files</span> <span class="o">||</span> <span class="nx">e</span><span class="p">.</span><span class="nx">dataTransfer</span><span class="p">.</span><span class="nx">files</span><span class="p">;</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="nx">fileselect</span><span class="p">.</span><span class="nx">files</span> <span class="o">=</span> <span class="nx">files</span><span class="p">;</span>
        <span class="nx">submitbutton</span><span class="p">.</span><span class="nx">click</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">let</span> <span class="nx">fileselect</span> <span class="o">=</span> <span class="nx">$id</span><span class="p">(</span><span class="dl">"</span><span class="s2">fileselect</span><span class="dl">"</span><span class="p">),</span>
		<span class="nx">filedrag</span> <span class="o">=</span> <span class="nx">$id</span><span class="p">(</span><span class="dl">"</span><span class="s2">filedrag</span><span class="dl">"</span><span class="p">),</span>
        <span class="nx">submitbutton</span> <span class="o">=</span> <span class="nx">$id</span><span class="p">(</span><span class="dl">"</span><span class="s2">submitbutton</span><span class="dl">"</span><span class="p">);</span>
        
    <span class="nx">fileselect</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">"</span><span class="s2">change</span><span class="dl">"</span><span class="p">,</span> <span class="nx">FileSelectHandler</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
    <span class="kd">let</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">upload</span><span class="p">)</span> <span class="p">{</span>
		<span class="c1">// file drop</span>
		<span class="nx">filedrag</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">"</span><span class="s2">dragover</span><span class="dl">"</span><span class="p">,</span> <span class="nx">FileDragHover</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
		<span class="c1">// filedrag.addEventListener("dragleave", FileDragHover, false);</span>
		<span class="nx">filedrag</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">"</span><span class="s2">drop</span><span class="dl">"</span><span class="p">,</span> <span class="nx">FileSelectHandler</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
		<span class="c1">// filedrag.style.display = "block";</span>
	<span class="p">}</span>

<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>

</code></pre></div></div>
:ET